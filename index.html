<!DOCTYPE html>
<html>
<head>
  <title>Fixerr Booking</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>Book a Repair</h2>
  <form id="bookingForm">
    <input type="text" id="name" placeholder="Your Name" required><br><br>
    <input type="text" id="item" placeholder="Item (e.g., Laptop, Kettle)" required><br><br>
    <input type="file" id="photo" accept="image/*" required><br><br>
    <button type="submit">Submit Booking</button>
  </form>

  <p id="status"></p>

  <script>
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCh1RX8BSAtgGULDXEU-7RlFYPLru4THEI",
      authDomain: "fixerrappsa.firebaseapp.com",
      projectId: "fixerrappsa",
      storageBucket: "fixerrappsa.firebasestorage.app",
      messagingSenderId: "397397274379",
      appId: "1:397397274379:web:17abd46ef77c70114f7c0e",
      measurementId: "G-FQTG8V7LB2"
    };

    // Init Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    // Form logic
    document.getElementById('bookingForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const item = document.getElementById('item').value;
      const file = document.getElementById('photo').files[0];

      if (!file) return alert("Please upload a photo.");

      const fileRef = storage.ref('uploads/' + file.name);
      await fileRef.put(file);
      const fileURL = await fileRef.getDownloadURL();

      await db.collection('bookings').add({
        name,
        item,
        photoURL: fileURL,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      });

      document.getElementById('status').innerText = "âœ… Booking submitted!";
      document.getElementById('bookingForm').reset();
    });
  </script>
</body>
</html>
